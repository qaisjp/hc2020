(this.webpackJsonphc2020=this.webpackJsonphc2020||[]).push([[0],{1495:function(e,t){function i(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}i.keys=function(){return[]},i.resolve=i,e.exports=i,i.id=1495},1499:function(e,t,i){},1500:function(e,t,i){"use strict";i.r(t);var a=i(68),n=i.n(a),s=i(563),o=i.n(s),r=(i(574),i(575),i(9)),h=i(11),c=i(18),l=i(12),d=i(22),u=i(15),y=i.n(u),p=i(564),v=i.n(p),f=i(565),m=i.n(f),g=i(566),_=i.n(g),b=i(567),x=i.n(b),w=i(170),k=i(127),P=i.n(k),O=i(23),S=i.n(O),j=function(){function e(t,i){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"peer";Object(r.a)(this,e),this.id=void 0,this.dataConnection=void 0,this.name=void 0,this.id=t,this.dataConnection=i,this.name=a}return Object(h.a)(e,[{key:"send",value:function(e,t,i){this.dataConnection.send(S.a.extend(i,{from:e,type:t}))}},{key:"on",value:function(e,t){this.dataConnection.on(e,t)}},{key:"destroy",value:function(){this.dataConnection.destroy()}}]),e}(),M="open",G="connection",T="close",C="data",D="error",I=0,A=1,E=2,H=3,R=4,U=5,B=6,K=7,L=8,N=9,W=10,z=11;function V(e,t){var i,a,n,s,o,r,h,c;return P.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return console.log("Connected to PeerServer with id: ".concat(e)),console.log(this),l.next=4,P.a.awrap(this.getAllPeers());case 4:for(i=l.sent,1===(a=i.peers).length&&t(),n=!0,s=!1,o=void 0,l.prev=10,r=a[Symbol.iterator]();!(n=(h=r.next()).done);n=!0)(c=h.value)!==e&&this.connectToPeer(c);l.next=18;break;case 14:l.prev=14,l.t0=l.catch(10),s=!0,o=l.t0;case 18:l.prev=18,l.prev=19,n||null==r.return||r.return();case 21:if(l.prev=21,!s){l.next=24;break}throw o;case 24:return l.finish(21);case 25:return l.finish(18);case 26:this._id=e,this._signals[M].dispatch(e);case 28:case"end":return l.stop()}}),null,this,[[10,14,18,26],[19,,21,25]])}function F(e){var t=this;console.log("".concat(e.peer," connected to us")),e.on(C,(function(e){return Y.call(t,e)})),e.on(T,(function(){return Q.call(t,e.peer)})),e.on(D,(function(e){return X.call(t,e)})),S.a.has(this._signals,G)&&this._signals[G].dispatch(e.peer)}function X(e){console.log(e)}function Y(e){var t=e.type;S.a.isUndefined(t)?console.log("Error: unrecognised message with type: ".concat(t)):this._signals[C].dispatch(t,e)}function Q(e){S.a.has(this.connectedPeers,e)&&(delete this.connectedPeers[e],this._signals[T].dispatch(e))}var J=i(568),q=i.n(J),$=window.location.hostname,Z=window.location.protocol,ee="".concat("/multi","/peerjs/peers"),te=function(){function e(){Object(r.a)(this,e),this.dispatchers=[],this.dispatchers=[]}return Object(h.a)(e,[{key:"add",value:function(e,t){this.dispatchers.push({func:e,ctx:t})}},{key:"dispatch",value:function(){var e=!0,t=!1,i=void 0;try{for(var a,n=this.dispatchers[Symbol.iterator]();!(e=(a=n.next()).done);e=!0){var s=a.value,o=s.func.bind(s.ctx);o.apply(void 0,arguments)}}catch(r){t=!0,i=r}finally{try{e||null==n.return||n.return()}finally{if(t)throw i}}}}]),e}(),ie=function(){function e(t){Object(r.a)(this,e),this.peer=void 0,this._level=void 0,this.connectedPeers=void 0,this.peerMessageQueue=void 0,this._id=void 0,this._signals=void 0,this.leader=void 0,this.peer=new q.a({host:$,port:parseInt("9000"),path:"/multi"}),this._level=t,this.connectedPeers={},this.peerMessageQueue={},this._id="",this._signals={},this.leader=!1,this._addEventListeners()}return Object(h.a)(e,[{key:"addListener",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._signals[e]=new te,this._signals[e].add(t,i)}},{key:"getAllPeers",value:function(e){var t,i,a,n=this,s=arguments;return P.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>1&&void 0!==s[1]?s[1]:null,i=new XMLHttpRequest,a="".concat(Z,"//").concat($,":").concat("9000").concat(ee),e.abrupt("return",new Promise((function(e,s){i.onreadystatechange=function(a){if(4===i.readyState&&200===i.status){var s=S.a.reject(JSON.parse(i.responseText),(function(e){return e===n._id}));e({ctx:t,peers:s})}},i.open("GET",a,!0),i.send()})));case 4:case"end":return e.stop()}}))}},{key:"broadcastToPeers",value:function(e,t){var i=this;S.a.each(this.connectedPeers,(function(a){a.send(i._id,e,t)}))}},{key:"sendToPeer",value:function(e,t,i){S.a.has(this.connectedPeers,e)?this.connectedPeers[e].send(this._id,t,i):console.log("Error: not connected to peer ".concat(e))}},{key:"connectToPeer",value:function(e){var t=this;if(!S.a.has(this.connectedPeers,e)){var i=this.peer.connect(e);console.log("Connecting to peer: ".concat(e)),this.connectedPeers[e]=new j(e,i),this.connectedPeers[e].on(M,(function(i){if(t.sendToPeer(e,I,{x:t._level.localPlayer.x,y:t._level.localPlayer.y}),t.peerMessageQueue[e]){var a=!0,n=!1,s=void 0;try{for(var o,r=t.peerMessageQueue[e][Symbol.iterator]();!(a=(o=r.next()).done);a=!0){var h=o.value;t.sendToPeer(e,h.type,h.data)}}catch(c){n=!0,s=c}finally{try{a||null==r.return||r.return()}finally{if(n)throw s}}}}))}}},{key:"destroy",value:function(){this.peer&&!this.peer.destroyed&&(console.log("Destroying..."),this.peer.destroy())}},{key:"_addEventListeners",value:function(){var e=this;this.peer.on("open",(function(t){return V.call(e,t,(function(){e.leader=!0}))})),this.peer.on("connection",(function(t){return F.call(e,t)})),this.peer.on("error",(function(e){return X(e)}))}}]),e}(),ae=i(169),ne=function(e){function t(e,i,a,n){var s,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,h=(arguments.length>5&&void 0!==arguments[5]&&arguments[5],!(arguments.length>6&&void 0!==arguments[6])||arguments[6],arguments.length>7&&void 0!==arguments[7]?arguments[7]:1),d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:8;return Object(r.a)(this,t),s=Object(c.a)(this,Object(l.a)(t).call(this,e,i,a,"plumber_bros",n,d)),o&&o.add(Object(ae.a)(s)),s.align=h,s}return Object(d.a)(t,e),t}(y.a.GameObjects.BitmapText),se=function(e){function t(e,i,a,n,s){var o;return Object(r.a)(this,t),o=0!==s?Object(c.a)(this,Object(l.a)(t).call(this,e,i,a,n,10,5460819)):Object(c.a)(this,Object(l.a)(t).call(this,e,i,a,10,n,5460819)),Object(c.a)(o)}return Object(d.a)(t,e),Object(h.a)(t,[{key:"setup",value:function(e,t){e.add.existing(this)}},{key:"pause",value:function(){}},{key:"resume",value:function(){}},{key:"_addAnimations",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2]}},{key:"update",value:function(){}}]),t}(y.a.GameObjects.Rectangle),oe=function(e){function t(e,i,a){var n,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"left";Object(r.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).x=void 0,n.y=void 0,n.opened=void 0,n.top=void 0,n.bottom=void 0,n.cover=void 0,n.type=void 0,n.x=i,n.y=a,n.scene=e,n.opened=!1;return"left"===s&&5,n.top=new y.a.GameObjects.Rectangle(e,n.x,n.y-60,10,60,5460819),n.top.setOrigin(.5,0),n.bottom=new y.a.GameObjects.Rectangle(e,n.x,n.y+60,10,60,5460819),n.bottom.setOrigin(.5,1),n.cover=new y.a.GameObjects.Rectangle(e,n.x,n.y,10,110,16777215),n.type=s,n}return Object(d.a)(t,e),Object(h.a)(t,[{key:"setup",value:function(e){this.add(this.cover),e.add.existing(this.cover),this.add(this.top),e.add.existing(this.top),this.add(this.bottom),e.add.existing(this.bottom)}},{key:"openImmediate",value:function(){"left"===this.type?(this.bottom.rotation=Math.PI/2,this.top.rotation=-Math.PI/2):"right"===this.type&&(this.bottom.rotation=-Math.PI/2,this.top.rotation=Math.PI/2),this.opened=!0}},{key:"open",value:function(){"left"===this.type?(this.scene.tweens.add({targets:this.bottom,rotation:Math.PI/2}),this.scene.tweens.add({targets:this.top,rotation:-Math.PI/2})):"right"===this.type&&(this.scene.tweens.add({targets:this.bottom,rotation:-Math.PI/2}),this.scene.tweens.add({targets:this.top,rotation:Math.PI/2})),this.opened=!0}},{key:"close",value:function(){this.scene.tweens.add({targets:this.top,rotation:0}),this.scene.tweens.add({targets:this.bottom,rotation:0}),this.opened=!1}},{key:"_addAnimations",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2]}}]),t}(y.a.GameObjects.Group),re=function(e){function t(e,i,a){var n,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"bottom";Object(r.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).x=void 0,n.y=void 0,n.opened=void 0,n.left=void 0,n.right=void 0,n.cover=void 0,n.type=void 0,n.x=i,n.y=a,n.scene=e,n.opened=!1;var o=-5;return"top"===s&&(o=5),n.left=new y.a.GameObjects.Rectangle(e,n.x-60,n.y+o,60,10,5460819),n.left.setOrigin(0,.5),n.right=new y.a.GameObjects.Rectangle(e,n.x+60,n.y+o,60,10,5460819),n.right.setOrigin(1,.5),n.cover=new y.a.GameObjects.Rectangle(e,n.x,n.y,110,10,16777215),n.type=s,n}return Object(d.a)(t,e),Object(h.a)(t,[{key:"setup",value:function(e){this.add(this.cover),e.add.existing(this.cover),this.add(this.left),e.add.existing(this.left),this.add(this.right),e.add.existing(this.right)}},{key:"openImmediate",value:function(){this.opened=!0,"bottom"===this.type?(this.right.rotation=Math.PI/2,this.left.rotation=-Math.PI/2):"top"===this.type&&(this.right.rotation=-Math.PI/2,this.left.rotation=Math.PI/2)}},{key:"open",value:function(){this.opened=!0,"top"===this.type?(this.scene.tweens.add({targets:this.right,rotation:-Math.PI/2}),this.scene.tweens.add({targets:this.left,rotation:Math.PI/2})):"bottom"===this.type&&(this.scene.tweens.add({targets:this.right,rotation:Math.PI/2}),this.scene.tweens.add({targets:this.left,rotation:-Math.PI/2}))}},{key:"close",value:function(){this.opened=!1,this.scene.tweens.add({targets:this.left,rotation:0}),this.scene.tweens.add({targets:this.right,rotation:0}),this.opened=!1}},{key:"resume",value:function(){}},{key:"_addAnimations",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2]}}]),t}(y.a.GameObjects.Group),he=function(){function e(t,i,a){Object(r.a)(this,e),this.x=void 0,this.y=void 0,this._blockGroup=void 0,this.doors=void 0,this.x=i,this.y=a,this._blockGroup=t.physics.add.staticGroup(),this.doors=[]}return Object(h.a)(e,[{key:"setup",value:function(e){for(var t=0,i=[{x:this.x,y:this.y,length:500,angle:90},{x:this.x+250,y:this.y-125+5,length:250,angle:0},{x:this.x+375-5,y:this.y-250+5,length:250,angle:90},{x:this.x+500-5,y:this.y-500+10,length:500,angle:0},{x:this.x+375,y:this.y-750+10,length:250,angle:90},{x:this.x+250,y:this.y-875+15,length:250,angle:0},{x:this.x,y:this.y-1e3+20,length:500,angle:90},{x:this.x-250,y:this.y-875+15,length:250,angle:0},{x:this.x-375,y:this.y-750+10,length:250,angle:90},{x:this.x-500+5,y:this.y-500+10,length:500,angle:0},{x:this.x-375+5,y:this.y-250+5,length:250,angle:90},{x:this.x-250,y:this.y-125+5,length:250,angle:0}];t<i.length;t++){var a=i[t],n=new se(e,a.x,a.y,a.length,a.angle);n.setup(e,this._blockGroup),this._blockGroup.add(n)}var s=new oe(e,this.x-500+5,this.y-500+10,"left");s.setup(e);var o=new oe(e,this.x+500-5,this.y-500+10,"right");o.setup(e);var r=new re(e,this.x,this.y-1e3+20,"top");r.setup(e);var h=new re(e,this.x,this.y,"bottom");h.setup(e),this.doors.push(s,o,r,h)}}]),e}(),ce=i(171),le=function(e){function t(e,i,a,n,s){return Object(r.a)(this,t),Object(c.a)(this,Object(l.a)(t).call(this,e,i,a,n,s))}return Object(d.a)(t,e),Object(h.a)(t,[{key:"setup",value:function(e){e.physics.world.enable(this),e.add.existing(this)}},{key:"pause",value:function(){}},{key:"resume",value:function(){}},{key:"flip",value:function(){}},{key:"_addAnimations",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2]}}]),t}(y.a.Physics.Arcade.Sprite),de=function(e){function t(e,i,a){var n,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"local",o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;return Object(r.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e,i,a,"idle_spear",0))).id=void 0,n.jumpReleased=void 0,n._jumping=void 0,n._grounded=void 0,n._sprinting=void 0,n._turning=void 0,n._moving=void 0,n.cursors=void 0,n._velocity=void 0,n._accel=void 0,n._clickDown=void 0,n.isNew=void 0,n.currentScale=void 0,n.createSpear=void 0,n.isPlayer=void 0,n.hasSpear=void 0,n.currentAnimation=void 0,n.scene.anims.create({key:"idle_spear",frames:[{key:"player",frame:"pixil-frame-0.png"},{key:"player",frame:"pixil-frame-1.png"}],frameRate:2,repeat:-1}),n.scene.anims.create({key:"walk_spear",frames:[{key:"player",frame:"pixil-frame-2.png"},{key:"player",frame:"pixil-frame-3.png"},{key:"player",frame:"pixil-frame-4.png"},{key:"player",frame:"pixil-frame-5.png"}],frameRate:2,repeat:-1}),n.scene.anims.create({key:"idle_nospear",frames:[{key:"player",frame:"pixil-frame-6.png"},{key:"player",frame:"pixil-frame-7.png"}],frameRate:2,repeat:-1}),n.scene.anims.create({key:"walk_nospear",frames:[{key:"player",frame:"pixil-frame-8.png"},{key:"player",frame:"pixil-frame-9.png"},{key:"player",frame:"pixil-frame-10.png"},{key:"player",frame:"pixil-frame-11.png"}],frameRate:2,repeat:-1}),n.id=s,n.isPlayer=o,n.jumpReleased=!0,n._jumping=!1,n._grounded=!1,n._sprinting=!1,n._turning=!1,n._moving=[],n._clickDown=!1,n.createSpear=h,n.hasSpear=!0,n.isNew=!0,n.currentScale=2.8,n.currentAnimation="idle_spear",n}return Object(d.a)(t,e),Object(h.a)(t,[{key:"setup",value:function(e){if(Object(ce.a)(Object(l.a)(t.prototype),"setup",this).call(this,e),this.anims.play("idle_spear"),this.setSize(200,200),this.setScale(.01),this.cursors=this.scene.input.keyboard.addKeys({up:Phaser.Input.Keyboard.KeyCodes.W,down:Phaser.Input.Keyboard.KeyCodes.S,left:Phaser.Input.Keyboard.KeyCodes.A,right:Phaser.Input.Keyboard.KeyCodes.D}),this.setCollideWorldBounds(!1),this.body){var i=this.body;this._velocity=i.velocity,this._accel=i.acceleration,i.setDrag(1200,1200),i.setMaxSpeed(300)}}},{key:"update",value:function(){if(this.isNew)return this.scale=this.currentScale,this.currentScale-=.05,void(this.currentScale<=.2&&(this.isNew=!1,this.scale=.2,this.scene.cameras.main.shake(200,.005)));if(this.cursors&&this.body&&this.isPlayer){var e=this.body,t=this.scene.input.activePointer,i=Phaser.Math.Angle.Between(e.x,e.y,t.x+this.scene.cameras.main.scrollX,t.y+ +this.scene.cameras.main.scrollY);t.isDown?this._clickDown=!0:this._clickDown&&this.createSpear&&this.hasSpear?(this.createSpear(),this.hasSpear=!1,this._clickDown=!1):this._clickDown=!1;var a=i/(2*Math.PI)*360;e.rotation=a;var n=0,s=0;this.cursors.left&&this.cursors.left.isDown?(!0,n=-6e3):this.cursors.right&&this.cursors.right.isDown?(!0,n=6e3):n=0,this.cursors.down&&this.cursors.down.isDown?(!0,s=6e3):this.cursors.up&&this.cursors.up.isDown?(!0,s=-6e3):s=0,e.setAccelerationX(n),e.setAccelerationY(s)}}},{key:"jump",value:function(){}},{key:"sprint",value:function(e){}},{key:"move",value:function(e,t){}},{key:"_updateAnimations",value:function(){}}]),t}(le),ue=function(e){function t(e,i,a,n){var s,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return Object(r.a)(this,t),console.log("SPEAR:",i,a,o),(s=Object(c.a)(this,Object(l.a)(t).call(this,e,i,a,"spear",0))).id=void 0,s._angle=void 0,s._velocity=void 0,s._initSpeed=void 0,s._maxSpeed=void 0,s._wallHit=void 0,s._monstersHit=void 0,s.id=n,s._angle=o,s._initSpeed=1500,s._maxSpeed=6e3,s._wallHit=!1,s._monstersHit=e.add.group(),s}return Object(d.a)(t,e),Object(h.a)(t,[{key:"setup",value:function(e,t){if(e.physics.world.enable(this),e.add.existing(this),t.add(this),this.setSize(50,50),this.setDisplaySize(40,40),this.body){var i=this.body;i.rotation=this._angle/(2*Math.PI)*360;var a=this._initSpeed;i.setVelocity(a*Math.cos(this._angle),a*Math.sin(this._angle)),i.setDrag(Math.abs(1e3*Math.cos(this._angle)),Math.abs(1e3*Math.sin(this._angle))),this._velocity=i.velocity,i.setMaxSpeed(this._maxSpeed)}}},{key:"onWallHit",value:function(){this._wallHit||(this._wallHit=!0,this.scene.cameras.main.shake(25,.01,!0))}},{key:"onHitMonster",value:function(e){this._monstersHit.contains(e)||(this._monstersHit.add(e),this.scene.cameras.main.shake(20,.02,!1))}},{key:"update",value:function(){if(this.body){var e=this.body;e.rotation=this._angle/(2*Math.PI)*360+90,this._wallHit?(e.setVelocityX(0),e.setVelocityY(0),e.setImmovable()):(e.speed<200&&(e.setVelocityX(200*Math.cos(this._angle)),e.setVelocityY(200*Math.sin(this._angle))),this._velocity=e.velocity),this._monstersHit.setXY(e.position.x,e.position.y)}}},{key:"_addAnimations",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2]}}]),t}(y.a.Physics.Arcade.Sprite),ye=function(e){function t(e,i,a,n){var s;return Object(r.a)(this,t),(s=Object(c.a)(this,Object(l.a)(t).call(this,e,i,a,"monster",0))).id=void 0,s.isHit=void 0,s.createLaser=void 0,s._rand=void 0,s._numUpdates=void 0,s._numRand=void 0,s.playingHit=void 0,s.scene.anims.create({key:"walk",frames:[{key:"monster",frame:"pixil-frame-0.png"},{key:"monster",frame:"pixil-frame-1.png"}],frameRate:2,repeat:-1}),s.scene.anims.create({key:"appear",frames:[{key:"monster",frame:"pixil-frame-2.png"},{key:"monster",frame:"pixil-frame-3.png"},{key:"monster",frame:"pixil-frame-4.png"},{key:"monster",frame:"pixil-frame-5.png"}],frameRate:6,repeat:0}),s.scene.anims.create({key:"death",frames:[{key:"monster",frame:"pixil-frame-7.png"},{key:"monster",frame:"pixil-frame-8.png"},{key:"monster",frame:"pixil-frame-9.png"},{key:"monster",frame:"pixil-frame-10.png"}],frameRate:6,repeat:0}),s.id=n,s.isHit=!1,s._rand=new Phaser.Math.RandomDataGenerator([n]),s._numUpdates=0,s.playingHit=!1,s._numRand=0,s}return Object(d.a)(t,e),Object(h.a)(t,[{key:"setup",value:function(e,t){var i=this;if(this.setScale(.3,.3),this.anims.play("appear"),this.scene.time.delayedCall(666,(function(e){i.anims.play("walk")})),this.createLaser=t,e.physics.world.enable(this),e.add.existing(this),this.body){var a=this.body;a.setDrag(1200,1200),a.setMaxSpeed(300),a.setSize(a.width-2,a.height)}}},{key:"catchUp",value:function(){for(var e=0,t=Object(w.a)(Array(this._numRand).keys());e<t.length;e++){t[e];this._rand.frac()}}},{key:"update",value:function(){if(this.body){if(this.isHit&&!this.playingHit)return this.anims.play("death"),void(this.playingHit=!0);var e=this.body;if(this._numUpdates%30===0){this._numUpdates=0;var t=this._rand.frac();this._numRand=this._numRand+1;t<.2125?e.setVelocityX(-300):t<.425?e.setVelocityX(300):t<.6375?e.setVelocityY(300):t<.85?e.setVelocityY(-300):this.createLaser&&this.createLaser(this)}this._numUpdates=this._numUpdates+1}}}]),t}(Phaser.Physics.Arcade.Sprite),pe=function(e){function t(e,i,a,n){var s,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return Object(r.a)(this,t),(s=Object(c.a)(this,Object(l.a)(t).call(this,e,i,a,"laser",0))).id=void 0,s._angle=void 0,s._velocity=void 0,s._initSpeed=void 0,s.id=n,s._angle=o,s._initSpeed=100,s}return Object(d.a)(t,e),Object(h.a)(t,[{key:"setup",value:function(e,t){if(e.physics.world.enable(this),e.add.existing(this),t.add(this),this.setSize(20,20),this.setDisplaySize(20,20),this.body){var i=this.body;i.rotation=this._angle/(2*Math.PI)*360;var a=this._initSpeed;i.setVelocity(a*Math.cos(this._angle),a*Math.sin(this._angle)),this._velocity=i.velocity}}},{key:"update",value:function(){this.body&&(this.body.rotation=this._angle/(2*Math.PI)*360+90)}},{key:"_addAnimations",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2]}}]),t}(y.a.Physics.Arcade.Sprite),ve=function(e){function t(e,i,a){var n;arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Object(r.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e,i,a,"ghost",0))).cursors=void 0,n}return Object(d.a)(t,e),Object(h.a)(t,[{key:"setup",value:function(e){if(Object(ce.a)(Object(l.a)(t.prototype),"setup",this).call(this,e),this.cursors=this.scene.input.keyboard.addKeys({up:Phaser.Input.Keyboard.KeyCodes.W,down:Phaser.Input.Keyboard.KeyCodes.S,left:Phaser.Input.Keyboard.KeyCodes.A,right:Phaser.Input.Keyboard.KeyCodes.D}),this.setCollideWorldBounds(!1),this.body){var i=this.body;i.setDrag(1200,1200),i.setMaxSpeed(300),i.setSize(i.width-2,i.height)}}},{key:"update",value:function(){if(this.cursors&&this.body){var e=this.body,t=0,i=0;t=this.cursors.left&&this.cursors.left.isDown?-6e3:this.cursors.right&&this.cursors.right.isDown?6e3:0,i=this.cursors.down&&this.cursors.down.isDown?6e3:this.cursors.up&&this.cursors.up.isDown?-6e3:0,e.setAccelerationX(t),e.setAccelerationY(i)}}}]),t}(le),fe=i(1496),me=[1,2,3,5,10],ge=function(){function e(t,i){var a=this;Object(r.a)(this,e),this.network=void 0,this.remotePlayers=void 0,this._connectionStatusText=void 0,this._introText=void 0,this._titleSprite=void 0,this._deadText=void 0,this._startText=void 0,this._instructionText=void 0,this._malwareText=void 0,this._entitiesGroup=void 0,this._spearGroup=void 0,this._laserGroup=void 0,this._monsterGroup=void 0,this._blockGroup=void 0,this._physics=void 0,this.staticObjects=void 0,this.localPlayer=void 0,this.blocksGroup=void 0,this.itemBlocksGroup=void 0,this.game=void 0,this.scene=void 0,this.leader=void 0,this.dead=void 0,this.broadcastTimer=void 0,this.ghost=void 0,this.gameStarted=void 0,this.spawning=void 0,this.canSpawn=void 0,this.arena=void 0,this.waveNumber=void 0,this.createLaser=function(e){var t,i=fe(),n=1e11;a.dead||(t=a.localPlayer,n=Phaser.Math.Distance.Between(e.body.x,e.body.y,a.localPlayer.body.x,a.localPlayer.body.y));var s=!0,o=!1,r=void 0;try{for(var h,c=a.remotePlayers.getChildren()[Symbol.iterator]();!(s=(h=c.next()).done);s=!0){var l=h.value,d=Phaser.Math.Distance.Between(e.body.x,e.body.y,l.body.x,l.body.y);d<n&&(n=d,t=l)}}catch(y){o=!0,r=y}finally{try{s||null==c.return||c.return()}finally{if(o)throw r}}if(t){var u=Phaser.Math.Angle.Between(e.body.x,e.body.y,t.body.x,t.body.y);new pe(a.scene,e.x,e.y,i,u).setup(a.scene,a._laserGroup)}},this.game=t,this.scene=i,this.remotePlayers=null,this.staticObjects=new Phaser.Physics.Arcade.Group(this.scene.physics.world,i),this.leader=!1,this._connectionStatusText=null,this.dead=!1,this.waveNumber=0,window.onunload=window.onbeforeunload=function(e){a._disconnect()},this.gameStarted=!1,this.spawning=!1,this.canSpawn=!1,this._entitiesGroup=this.scene.add.group(),this._spearGroup=this.scene.add.group(),this._laserGroup=this.scene.add.group(),this._monsterGroup=this.scene.add.group(),this._blockGroup=this.scene.physics.add.staticGroup(),this.remotePlayers=this.scene.add.group(),this._introText=new ne(this.scene,-300,-200,"You've gone offline!",null,!0,!1,0,32),this._titleSprite=this.scene.add.sprite(0,-30,"malware"),this._titleSprite.setScale(2),this._deadText=new ne(this.scene,-190,-200,"He's dead Jim!",null,!0,!1,0,32),this._startText=new ne(this.scene,-270,100,"Press space to start playing",null,!0,!0,0,20),this._instructionText=new ne(this.scene,-280,350,"WASD to move. Mouse to aim. Click to shoot.",null,!0,!1,0,14),this._malwareText=new ne(this.scene,-220,390,"Fight the malwares for your life",null,!0,!1,0,14),this.scene.add.existing(this._introText),this.scene.add.existing(this._startText),this.scene.add.existing(this._instructionText),this.scene.add.existing(this._deadText),this._deadText.alpha=0,this._deadText.depth=20,this.scene.add.existing(this._malwareText),this.scene.cameras.main.centerOn(0,100)}return Object(h.a)(e,[{key:"shutdown",value:function(){this.remotePlayers.destroy(),setTimeout((function(){window.location.href=""}),700)}},{key:"_createWorld",value:function(){var e=this;this.network=new ie(this),this.scene.add.sprite(0,-180,"avast"),this._connectionStatusText=new ne(this.scene,0,-50,"connecting...",null,!0,!1,0),this.scene.add.existing(this._connectionStatusText),this.network.addListener(M,this._onOpen,this),this.network.addListener(C,this._onData,this),this.network.addListener(T,this._onClose,this);this.localPlayer=new de(this.scene,0,-185,"local",!0,(function(){var t=fe(),i=e.localPlayer.rotation,a=new ue(e.scene,e.localPlayer.x,e.localPlayer.y,t,i);e.network.broadcastToPeers(R,{id:t,rotation:a._angle,x:Math.round(e.localPlayer.x),y:Math.round(e.localPlayer.y)}),a.setup(e.scene,e._spearGroup)})),this.localPlayer.setup(this.scene),this.scene.cameras.main.startFollow(this.localPlayer),this._entitiesGroup.add(this.localPlayer),this.arena=new he(this.scene,0,300),this.arena.setup(this.scene),this.scene.physics.add.collider(this.localPlayer,this.arena._blockGroup),this.scene.physics.add.collider(this._monsterGroup,this.arena._blockGroup),this.scene.physics.add.collider(this._laserGroup,this.arena._blockGroup,(function(t,i){var a=t;S.a.forEach(e._laserGroup.getChildren(),(function(e){e&&e.id===a.id&&e.destroy()}))})),this.scene.physics.add.overlap(this._laserGroup,this.localPlayer,(function(t,i){var a=t,n=i;"local"===n.id&&(S.a.forEach(e._laserGroup.getChildren(),(function(e){e&&e.id===a.id&&e.destroy()})),e.remotePlayers.children.size>0?(e.ghost=new ve(e.scene,n.body.x,n.body.y,"local"),e.ghost.setup(e.scene),e.scene.cameras.main.startFollow(e.ghost),e._entitiesGroup.add(e.ghost)):(e._deadText.alpha=1,e.shutdown()),n.destroy(),e.network.broadcastToPeers(L,{}),e.dead=!0,console.log("dead called"))})),this.scene.physics.add.collider(this._spearGroup,this.arena._blockGroup,(function(e,t){e.onWallHit()})),this.scene.physics.add.overlap(this._spearGroup,this._monsterGroup,(function(t,i){var a=t,n=i;n.isHit=!0,n.body.mass=0,a.onHitMonster(n),e.scene.time.delayedCall(666,(function(t){e.leader&&S.a.forEach(e._monsterGroup.getChildren(),(function(t){t&&t.id===n.id&&(t.destroy(),e.network.broadcastToPeers(N,{id:n.id}))}))}))})),this.scene.physics.add.collider(this._spearGroup,this.localPlayer,(function(t,i){var a=t,n=i;n.hasSpear||"local"!==n.id||(S.a.forEach(e._spearGroup.getChildren(),(function(e){e&&e.id===a.id&&e.destroy()})),e.network.broadcastToPeers(B,{id:a.id}),e.localPlayer.hasSpear=!0)}))}},{key:"_createMap",value:function(){throw new Error("Method not implemented.")}},{key:"_createMapObjects",value:function(){throw new Error("Method not implemented.")}},{key:"_updateCollision",value:function(){}},{key:"_collisionLayer",value:function(e,t){throw new Error("Method not implemented.")}},{key:"_updateEntities",value:function(){var e=!0,t=!1,i=void 0;try{for(var a,n=this._entitiesGroup.getChildren()[Symbol.iterator]();!(e=(a=n.next()).done);e=!0){a.value.update()}}catch(v){t=!0,i=v}finally{try{e||null==n.return||n.return()}finally{if(t)throw i}}var s=!0,o=!1,r=void 0;try{for(var h,c=this._spearGroup.getChildren()[Symbol.iterator]();!(s=(h=c.next()).done);s=!0){h.value.update()}}catch(v){o=!0,r=v}finally{try{s||null==c.return||c.return()}finally{if(o)throw r}}var l=!0,d=!1,u=void 0;try{for(var y,p=this._monsterGroup.getChildren()[Symbol.iterator]();!(l=(y=p.next()).done);l=!0){y.value.update()}}catch(v){d=!0,u=v}finally{try{l||null==p.return||p.return()}finally{if(d)throw u}}this.dead||this._broadcastPlayerUpdate(),this.leader&&this._broadcastMonstersUpdate()}},{key:"createMonster",value:function(e,t){var i=this,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=Math.ceil(100*(Math.random()-.5)),s=Math.ceil(100*(Math.random()-.5));this.scene.time.delayedCall(a?4e3*Math.random():1,(function(a){var o=new ye(i.scene,e+n,t+s,fe());o.setup(i.scene,i.createLaser),i._monsterGroup.add(o)}))}},{key:"update",value:function(){var e=this;if(this.gameStarted){if(this._updateEntities(),this.leader&&this.canSpawn&&this.arena&&!this.spawning&&0===this._monsterGroup.getChildren().length&&this.arena){this.spawning=!0;var t=!0,i=!1,a=void 0;try{for(var n,s=this.arena.doors[Symbol.iterator]();!(t=(n=s.next()).done);t=!0){n.value.open()}}catch(y){i=!0,a=y}finally{try{t||null==s.return||s.return()}finally{if(i)throw a}}this.network.broadcastToPeers(W,{});var o=me[this.waveNumber];this.waveNumber++;var r=!0,h=!1,c=void 0;try{for(var l,d=Object(w.a)(Array(o)).keys()[Symbol.iterator]();!(r=(l=d.next()).done);r=!0){l.value;var u=this.arena.doors;this.createMonster(u[0].x+120,u[0].y),this.createMonster(u[1].x-120,u[1].y),this.createMonster(u[2].x,u[2].y+120),this.createMonster(u[3].x,u[3].y-120)}}catch(y){h=!0,c=y}finally{try{r||null==d.return||d.return()}finally{if(h)throw c}}this.scene.time.delayedCall(2e3,(function(t){if(e.network.broadcastToPeers(z,{}),e.spawning=!1,e.arena){var i=!0,a=!1,n=void 0;try{for(var s,o=e.arena.doors[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){s.value.close()}}catch(y){a=!0,n=y}finally{try{i||null==o.return||o.return()}finally{if(a)throw n}}}}))}}else this.scene.input.keyboard.on("keydown",(function(t){switch(t.key){case" ":e.gameStarted||(e.gameStarted=!0,e._startText.destroy(),e._introText.destroy(),e._titleSprite.destroy(),e._deadText.alpha=0,e._createWorld())}}))}},{key:"_broadcastPlayerUpdate",value:function(){var e=this.localPlayer.body;this.network.broadcastToPeers(A,{rotation:this.localPlayer.rotation,state:this.localPlayer.currentState,x:Math.round(this.localPlayer.x),y:Math.round(this.localPlayer.y),vx:e.velocity.x.toFixed(2),vy:e.velocity.y.toFixed(2),hasSpear:this.localPlayer.hasSpear})}},{key:"_broadcastMonstersUpdate",value:function(){var e=this._monsterGroup.getChildren();this.network.broadcastToPeers(K,{monsters:e.map((function(e){return{id:e.id,rotation:e.rotation,x:Math.round(e.x),y:Math.round(e.y),vx:e.body.velocity.x.toFixed(2),vy:e.body.velocity.y.toFixed(2),numUpdates:e._numUpdates,numRand:e._numRand}}))})}},{key:"_disconnect",value:function(){this.network.destroy()}},{key:"_onOpen",value:function(e){var t=this;this.network.leader&&(this.leader=!0),this._connectionStatusText.setText("connected, id: ".concat(e,", leader: ").concat(this.leader)),this.arena&&this.scene.time.delayedCall(2e3,(function(e){t.canSpawn=!0}))}},{key:"_onData",value:function(e,t){var i=S.a.find(this.remotePlayers.getChildren(),(function(e){return e.id===t.from}));switch(e){case I:this._handleHello(t);break;case A:this._handlePlayerUpdate(i,t);break;case E:this._handleBlockBump(t);break;case H:this._handleItemBlockBump(t);break;case R:this._handleSpearCreated(t);break;case U:this._handleSyncSpears(t);break;case B:this._handleSpearPickedUp(t);break;case K:this._handleMonstersUpdate(t);break;case L:this._handlePlayerDead(i);break;case N:this._handleDeadMonster(t);break;case W:this._handleDoor(!0);break;case z:this._handleDoor(!1)}}},{key:"_onClose",value:function(e){S.a.forEach(this.remotePlayers.getChildren(),(function(t){t&&t.id===e&&t.destroy()}))}},{key:"_onBlockBump",value:function(e,t){e.body.touching.up&&this.network.broadcastToPeers(E,{idx:this.blocksGroup.getChildIndex(t)})}},{key:"_onItemBlockBump",value:function(e,t){e.body.touching.up&&this.network.broadcastToPeers(H,{idx:this.itemBlocksGroup.getChildIndex(t)})}},{key:"_handleHello",value:function(e){var t=this;console.log("hello from: ".concat(e.from)),this.network.connectToPeer(e.from),this._connectionStatusText.visible=!0,this._connectionStatusText.setText("player joined"),this.scene.time.delayedCall(5e3,(function(e){return t._connectionStatusText.visible=!1}));var i=new de(this.scene,e.x,e.y,e.from);i.setup(this.scene),this.remotePlayers.add(i),this._entitiesGroup.add(i),this.leader&&(this.network.peerMessageQueue[e.from]=[],this.network.peerMessageQueue[e.from].push({type:U,data:{spears:this._spearGroup.getChildren().map((function(e){var t=e;return{id:t.id,rotation:t._angle,x:Math.round(t.x),y:Math.round(t.y)}}))}}))}},{key:"_handlePlayerUpdate",value:function(e,t){var i=e.body;e.rotation=t.rotation,e.currentState=t.state,e.x=t.x,e.y=t.y,e.hasSpear=t.hasSpear,i.velocity.x=t.vx,i.velocity.y=t.vy}},{key:"_handleBlockBump",value:function(e){this.blocksGroup.getAt(e.idx).bump()}},{key:"_handleItemBlockBump",value:function(e){this.itemBlocksGroup.getAt(e.idx).bump()}},{key:"_handleSpearCreated",value:function(e){new ue(this.scene,e.x,e.y,e.id,e.rotation).setup(this.scene,this._spearGroup)}},{key:"_handleSyncSpears",value:function(e){var t=!0,i=!1,a=void 0;try{for(var n,s=e.spears[Symbol.iterator]();!(t=(n=s.next()).done);t=!0){var o=n.value;new ue(this.scene,o.x,o.y,o.id,o.rotation).setup(this.scene,this._spearGroup)}}catch(r){i=!0,a=r}finally{try{t||null==s.return||s.return()}finally{if(i)throw a}}}},{key:"_handleSpearPickedUp",value:function(e){S.a.forEach(this._spearGroup.getChildren(),(function(t){t&&t.id===e.id&&t.destroy()}))}},{key:"_handleMonstersUpdate",value:function(e){var t=this,i=e.monsters,a=this._monsterGroup.getChildren(),n=!0,s=!1,o=void 0;try{for(var r,h=function(){var e=r.value,i=a.find((function(t){return t.id===e.id}));if(i)i.rotation=e.rotation,i.x=e.x,i.y=e.y,i.body.velocity.x=e.vx,i.body.velocity.y=e.vy;else{var n=new ye(t.scene,e.x,e.y,e.id);n.setup(t.scene,t.createLaser),n.rotation=e.rotation,n.body.velocity.x=e.vx,n.body.velocity.y=e.vy,n._numRand=e.numRand,n._numUpdates=e.numUpdates,n.catchUp(),t._monsterGroup.add(n)}},c=i[Symbol.iterator]();!(n=(r=c.next()).done);n=!0)h()}catch(l){s=!0,o=l}finally{try{n||null==c.return||c.return()}finally{if(s)throw o}}}},{key:"_handlePlayerDead",value:function(e){S.a.forEach(this.remotePlayers.getChildren(),(function(t){t&&t.id===e.id&&t.destroy()}))}},{key:"_handleDeadMonster",value:function(e){S.a.forEach(this._monsterGroup.getChildren(),(function(t){t&&t.id===e.id&&t.destroy()}))}},{key:"_handleDoor",value:function(e){if(this.arena){var t=!0,i=!1,a=void 0;try{for(var n,s=this.arena.doors[Symbol.iterator]();!(t=(n=s.next()).done);t=!0){n.value.open()}}catch(o){i=!0,a=o}finally{try{t||null==s.return||s.return()}finally{if(i)throw a}}}}}]),e}(),_e=(i(1499),function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(c.a)(this,Object(l.a)(t).call(this,"MyScene"))).manager=void 0,e}return Object(d.a)(t,e),Object(h.a)(t,[{key:"preload",value:function(){this.load.image("logo",v.a),this.load.image("spear",m.a),this.load.image("avast",x.a),this.load.image("malware",_.a),this.load.bitmapFont("plumber_bros","res/fonts/plumber_bros_gray.png","res/fonts/plumber_bros.xml"),this.load.multiatlas("monster","res/monster.json","res"),this.load.multiatlas("player","res/player.json","res")}},{key:"update",value:function(){this.manager&&this.manager.update()}},{key:"create",value:function(){this.cameras.main.setBackgroundColor(16777215),this.manager=new ge(this.game,this)}}]),t}(y.a.Scene)),be=function(){return Object(a.useEffect)((function(){var e;console.log(window.innerWidth),window.addEventListener("resize",(function(){e.scale.resize(window.innerWidth,window.innerHeight)}));var t={type:y.a.AUTO,parent:"phaser-example",width:1920,height:1080,scene:_e,scale:{mode:y.a.Scale.NONE},physics:{default:"arcade",arcade:{debug:!1,fps:60}}};return(e=new y.a.Game(t)).scale.resize(window.innerWidth,window.innerHeight),function(){}}),[]),n.a.createElement("div",{id:"phaser-example"})},xe=function(){return n.a.createElement("div",{className:"App"},n.a.createElement(be,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(xe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},564:function(e,t,i){e.exports=i.p+"static/media/img.a16fe9ef.jpg"},565:function(e,t,i){e.exports=i.p+"static/media/spear_gray.4bf42d25.png"},566:function(e,t,i){e.exports=i.p+"static/media/malware_gladiator.145329ec.png"},567:function(e,t,i){e.exports=i.p+"static/media/avast_logo_light.e09ca6ab.png"},569:function(e,t,i){e.exports=i(1500)},574:function(e,t,i){},575:function(e,t,i){}},[[569,1,2]]]);
//# sourceMappingURL=main.376a9f56.chunk.js.map